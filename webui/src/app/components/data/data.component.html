<div class="container">

  <div class="dropdown">
    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false" id="dropdownDataSetButton">

      <span *ngIf="selectedDataSet; else noDataSetSelected">{{selectedDataSet.name}}</span>
      <ng-template #noDataSetSelected>{{'DATA.NO_DATA_SET' | translate}}</ng-template>
      <span class="caret"></span>
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownDataSetButton">
      <a class="dropdown-item clickable" *ngFor="let dataSet of dataSets" (click)="onSelectDataSet(dataSet)">{{dataSet.name}}</a>
    </div>
  </div>

  <app-chart *ngIf="selectedDataSet" [dataSet]="selectedDataSet"></app-chart>

  <div infinite-scroll [infiniteScrollDistance]="2"
       [infiniteScrollUpDistance]="1.5" [infiniteScrollThrottle]="50" (scrolled)="onScrollDown()"
       id="data-table" *ngIf="selectedDataSet" class="panel panel-default">
    <table class="table table-striped">
      <thead>
      <tr>
        <th *ngFor="let column of selectedDataSet.schema.columns">
          {{column.name}}
          <br>
          ({{column.type}})

          <div class="dropdown" (clickOutside)="onClickedOutside(column)">
            <span (click)="onClickedColumnSettings(column)" class="columnSettingsIcon fa fa-wrench clickable"></span>
            <div id="myDropdown" class="dropdown-content" [ngClass]="{'show': showColumnSettings[column.index]}">
              <a class="clickable" (click)="onClickedProcessFeature(column)">Process feature</a>
              <a class="clickable" (click)="onClickAddColumn(column, 0)">Add column the the left</a>
              <a class="clickable" (click)="onClickAddColumn(column, 1)">Add column the the right</a>
            </div>
          </div>

          <i class="fa fa-times clickable" aria-hidden="true" (click)="onSelectColumn(column)"
             data-toggle="modal" data-target="#removeColumnModal"></i>
        </th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let row of rows">
        <td *ngFor="let value of row.values; index as i">
          <span *ngIf="selectedDataSet.schema.columns[i].type == ColumnType.double; else notDouble">
            {{value | number : '1.2-2'}}
          </span>
          <ng-template #notDouble>{{value}}</ng-template>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <data-new-column-settings [visible]="showNewColumnSettings" [index]="newColumnIndex"></data-new-column-settings>

  <!-- Modal -->
  <div class="modal fade" id="removeColumnModal" tabindex="-1" role="dialog" aria-labelledby="removeColumnModalLabel"
       aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-body" *ngIf="selectedColumn">
          {{'DATA.REMOVE_COLUMN_QUESTION' | translate:{column_name: selectedColumn.name} }}
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            {{'NO' | translate}}
          </button>
          <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="onClickRemoveColumn()">
            {{'YES' | translate}}
          </button>
        </div>
      </div>
    </div>
  </div>

</div>
